<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DrawHelloKitty</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Comic Sans MS', cursive, sans-serif;
      background: linear-gradient(to bottom right, #ffe4f1, #ffc1e3);
      text-align: center;
      padding: 30px;
      color: #d63384;
      margin: 0;
      min-height: 100vh;
    }

    h1 {
      font-size: 40px;
      color: #ff4da6;
      text-shadow: 2px 2px 0px rgba(255, 255, 255, 0.8);
      margin-top: 0;
    }

    .toolbox {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
    }

    .section {
      background: rgba(255, 230, 240, 0.8);
      padding: 15px;
      border-radius: 15px;
      box-shadow: 0 4px 6px rgba(255, 138, 198, 0.5);
      min-width: 200px;
    }

    .section h3 {
      margin-bottom: 10px;
      margin-top: 0;
      color: #ff3399;
    }

    button, select, input[type="text"], input[type="color"] {
      font-family: inherit;
      background: #ffb3d9;
      border: none;
      padding: 8px 12px;
      margin: 5px;
      border-radius: 8px;
      box-shadow: 2px 2px 0 #ff5caa;
      cursor: pointer;
      transition: all 0.2s;
    }

    button:hover, select:hover {
      background: #ff99cc;
      transform: translateY(-2px);
    }

    button:active {
      transform: translateY(0);
    }

    #canvas {
      border: 4px dotted #fff;
      background: #ff66b2;
      margin-top: 20px;
      border-radius: 12px;
      cursor: crosshair;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
    }

    footer {
      margin-top: 30px;
      font-size: 16px;
      color: #aa1166;
    }

    .game-container {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 100;
      justify-content: center;
      align-items: center;
    }

    .game-window {
      background: #ffe6f0;
      padding: 20px;
      border-radius: 20px;
      width: 80%;
      max-width: 500px;
      box-shadow: 0 0 20px rgba(255, 140, 180, 0.8);
    }

    .game-canvas {
      background: white;
      border: 3px dashed #ff99cc;
      border-radius: 10px;
      margin: 10px auto;
      display: block;
    }

    .close-game {
      background: #ff5caa;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 8px;
      margin-top: 10px;
    }

    .sticker-palette {
      display: none;
      position: absolute;
      background: #ffe6f0;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      z-index: 10;
    }

    .sticker {
      font-size: 30px;
      cursor: pointer;
      margin: 5px;
      display: inline-block;
    }

    .sticker:hover {
      transform: scale(1.2);
    }

    .tab-container {
      display: flex;
      justify-content: center;
      margin-bottom: 15px;
    }

    .tab {
      padding: 8px 15px;
      background: #ffb3d9;
      border-radius: 8px 8px 0 0;
      margin: 0 5px;
      cursor: pointer;
    }

    .tab.active {
      background: #ff66b2;
      color: white;
    }

    .content-area {
      display: none;
    }

    .content-area.active {
      display: block;
    }

    .undo-redo {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 10px;
    }

    @media (max-width: 768px) {
      .toolbox {
        flex-direction: column;
        align-items: center;
      }
      #canvas {
        width: 95%;
        height: auto;
      }
      h1 {
        font-size: 30px;
      }
    }
  </style>
</head>
<body>
  <h1>Welcome to DrawHelloKitty! ‚úèÔ∏èüé®</h1>

  <div class="tab-container">
    <div class="tab active" onclick="switchTab('drawing')">Drawing</div>
    <div class="tab" onclick="switchTab('games')">Games</div>
    <div class="tab" onclick="switchTab('learn')">Learn to Draw</div>
  </div>

  <div id="drawing-tab" class="content-area active">
    <div class="toolbox">
      <div class="section">
        <h3>Brush Tools:</h3>
        <select id="brushType">
          <option value="crayon">Crayon</option>
          <option value="marker">Marker</option>
          <option value="pencil">Pencil</option>
          <option value="spray">Spray</option>
        </select>
        <h3>Color:</h3>
        <input type="color" id="colorPicker" value="#ff1493"/>
        <h3>Size: <span id="sizeValue">5</span></h3>
        <input type="range" id="sizeSlider" min="1" max="30" value="5"/>
      </div>

      <div class="section">
        <h3>Shapes:</h3>
        <button onclick="drawShape('circle')">‚≠ï Circle</button>
        <button onclick="drawShape('square')">‚¨õ Square</button>
        <button onclick="drawShape('line')">üìè Line</button>
        <button onclick="drawShape('triangle')">üî∫ Triangle</button>
        <button onclick="drawShape('star')">‚≠ê Star</button>
        <button onclick="drawShape('heart')">‚ù§Ô∏è Heart</button>
      </div>

      <div class="section">
        <h3>Stickers & Text:</h3>
        <button onclick="showStickers()">üéÄ Stickers</button>
        <button onclick="stampEmoji('üò∫')">üò∫ Kitty</button>
        <button onclick="stampEmoji('üå∏')">üå∏ Flower</button>
        <h3>Your Name:</h3>
        <input type="text" id="nameInput" placeholder="Enter your name"/>
        <button onclick="addName()">Add Name</button>
      </div>

      <div class="section">
        <h3>Canvas Tools:</h3>
        <button onclick="toggleEraser()">üßΩ Eraser</button>
        <button onclick="clearCanvas()">üóëÔ∏è Clear</button>
        <button onclick="fillCanvas()">üé® Fill Color</button>
        <div class="undo-redo">
          <button onclick="undo()">‚Ü©Ô∏è Undo</button>
          <button onclick="redo()">‚Ü™Ô∏è Redo</button>
        </div>
      </div>

      <div class="section">
        <h3>Save & Share:</h3>
        <button onclick="saveImage('png')">üíæ Save PNG</button>
        <button onclick="saveImage('jpeg')">üì∑ Save JPEG</button>
        <button onclick="saveImage('pdf')">üìÑ Save PDF</button>
        <button onclick="printCanvas()">üñ®Ô∏è Print</button>
        <h3>Background:</h3>
        <select onchange="changeTheme(this.value)">
          <option value="pink">Pink</option>
          <option value="sky">Sky Blue</option>
          <option value="mint">Mint Green</option>
          <option value="unicorn">Unicorn</option>
        </select>
      </div>

      <div class="section">
        <h3>Fun Presets:</h3>
        <select id="presetSelect" onchange="loadPreset()">
          <option value="">--Choose--</option>
          <option value="rainbow">üåà Rainbow</option>
          <option value="kitty">üê± Hello Kitty</option>
          <option value="house">üè† House</option>
          <option value="sunset">üåÖ Sunset</option>
        </select>
        <button onclick="startColoringBook()">üñçÔ∏è Coloring Book</button>
        <button onclick="startConnectDots()">üî¢ Connect Dots</button>
      </div>
    </div>

    <canvas id="canvas" width="700" height="500"></canvas>
  </div>

  <div id="games-tab" class="content-area">
    <div class="section" style="max-width: 600px; margin: 0 auto;">
      <h2>üéÆ Fun Games üéÆ</h2>
      <button onclick="startMemoryGame()" style="font-size: 20px; padding: 15px;">üß† Memory Match Game</button>
      <button onclick="startGuessingGame()" style="font-size: 20px; padding: 15px;">üé® Color Guessing Game</button>
      <button onclick="startDrawingGame()" style="font-size: 20px; padding: 15px;">‚úèÔ∏è Drawing Challenge</button>
    </div>
  </div>

  <div id="learn-tab" class="content-area">
    <div class="section" style="max-width: 600px; margin: 0 auto;">
      <h2>‚úèÔ∏è Learn to Draw ‚úèÔ∏è</h2>
      <div id="tutorial-steps">
        <h3>Let's draw a cute cat!</h3>
        <ol style="text-align: left;">
          <li>Draw a circle for the head</li>
          <li>Add two triangle ears on top</li>
          <li>Draw two dots for eyes and a small triangle for the nose</li>
          <li>Add whiskers with short lines</li>
          <li>Draw a smiling mouth</li>
        </ol>
        <button onclick="showStepByStep('cat')">Show Me How</button>
        
        <h3 style="margin-top: 20px;">Let's draw a flower!</h3>
        <ol style="text-align: left;">
          <li>Draw a small circle in the center</li>
          <li>Add petals around it (like a sun)</li>
          <li>Draw a stem with two lines</li>
          <li>Add leaves on the sides</li>
        </ol>
        <button onclick="showStepByStep('flower')">Show Me How</button>
      </div>
    </div>
  </div>

  <div class="sticker-palette" id="stickerPalette">
    <div class="sticker" onclick="stampEmoji('üò∫')">üò∫</div>
    <div class="sticker" onclick="stampEmoji('üê∂')">üê∂</div>
    <div class="sticker" onclick="stampEmoji('üê∞')">üê∞</div>
    <div class="sticker" onclick="stampEmoji('üêª')">üêª</div>
    <div class="sticker" onclick="stampEmoji('üå∏')">üå∏</div>
    <div class="sticker" onclick="stampEmoji('üåº')">üåº</div>
    <div class="sticker" onclick="stampEmoji('‚≠ê')">‚≠ê</div>
    <div class="sticker" onclick="stampEmoji('üåà')">üåà</div>
    <div class="sticker" onclick="stampEmoji('üçé')">üçé</div>
    <div class="sticker" onclick="stampEmoji('üç≠')">üç≠</div>
    <div class="sticker" onclick="stampEmoji('üéÄ')">üéÄ</div>
    <div class="sticker" onclick="stampEmoji('üéà')">üéà</div>
  </div>

  <div class="game-container" id="gameContainer">
    <div class="game-window">
      <h2 id="gameTitle">Game</h2>
      <canvas class="game-canvas" id="gameCanvas" width="400" height="400"></canvas>
      <div id="gameInstructions" style="margin: 10px 0;"></div>
      <div id="gameScore" style="font-weight: bold; margin: 10px 0;"></div>
      <button class="close-game" onclick="closeGame()">Close Game</button>
    </div>
  </div>

  <footer>Made with ‚ù§Ô∏è by Nakshu | ¬© 2023 DrawHelloKitty</footer>

  <script>
    // Canvas setup
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    const gameCanvas = document.getElementById("gameCanvas");
    const gameCtx = gameCanvas.getContext("2d");

    // Drawing state
    let drawing = false;
    let brushColor = "#ff1493";
    let brushSize = 5;
    let isEraser = false;
    let currentBrush = "crayon";
    let drawingHistory = [];
    let historyIndex = -1;
    let currentTool = "brush";
    let connectDotsMode = false;
    let dotPoints = [];
    let coloringBookMode = false;
    let coloringBookImage = null;
    let lastPoint = null;

    // Game state
    let currentGame = null;
    let gameScore = 0;
    let memoryCards = [];
    let flippedCards = [];
    let matchedCards = [];
    let colorOptions = [];
    let targetColor = "";
    let drawingChallengeWord = "";
    let drawingChallengeTimer = null;
    let timeLeft = 60;

    // Initialize
    document.getElementById("colorPicker").value = brushColor;
    document.getElementById("sizeSlider").oninput = function(e) {
      brushSize = e.target.value;
      document.getElementById("sizeValue").textContent = brushSize;
    };

    // Event listeners
    canvas.onmousedown = startDrawing;
    canvas.onmouseup = stopDrawing;
    canvas.onmouseleave = stopDrawing;
    canvas.onmousemove = draw;
    canvas.ontouchstart = handleTouchStart;
    canvas.ontouchmove = handleTouchMove;
    canvas.ontouchend = stopDrawing;

    document.getElementById("brushType").onchange = function(e) {
      currentBrush = e.target.value;
      isEraser = false;
    };

    document.getElementById("colorPicker").oninput = function(e) {
      brushColor = e.target.value;
      isEraser = false;
    };

    // Tab switching
    function switchTab(tab) {
      const tabs = document.querySelectorAll(".tab");
      const contents = document.querySelectorAll(".content-area");
      tabs.forEach(t => t.classList.remove("active"));
      contents.forEach(c => c.classList.remove("active"));
      document.querySelector(`.tab[onclick="switchTab('${tab}')"]`).classList.add("active");
      document.getElementById(`${tab}-tab`).classList.add("active");
      if (tab !== "drawing") {
        coloringBookMode = false;
        connectDotsMode = false;
      }
    }

    // Drawing functions
    function startDrawing(e) {
      if (coloringBookMode || connectDotsMode) {
        handleSpecialMode(e);
        return;
      }
      
      drawing = true;
      saveDrawingState();
      draw(e);
    }

    function stopDrawing() {
      drawing = false;
      ctx.beginPath();
      lastPoint = null;
    }

    function draw(e) {
      if (!drawing) return;
      
      const rect = canvas.getBoundingClientRect();
      const x = (e.clientX || e.touches[0].clientX) - rect.left;
      const y = (e.clientY || e.touches[0].clientY) - rect.top;
      
      ctx.lineJoin = "round";
      ctx.lineCap = "round";
      
      if (isEraser) {
        ctx.globalCompositeOperation = "destination-out";
        ctx.strokeStyle = "rgba(0,0,0,1)";
      } else {
        ctx.globalCompositeOperation = "source-over";
        ctx.strokeStyle = brushColor;
        ctx.fillStyle = brushColor;
      }
      
      ctx.lineWidth = brushSize;
      
      switch(currentBrush) {
        case "crayon":
          drawCrayon(x, y);
          break;
        case "marker":
          drawMarker(x, y);
          break;
        case "pencil":
          drawPencil(x, y);
          break;
        case "spray":
          drawSpray(x, y);
          break;
        default:
          drawCrayon(x, y);
      }
    }

    function drawCrayon(x, y) {
      if (lastPoint) {
        ctx.beginPath();
        ctx.moveTo(lastPoint.x, lastPoint.y);
        ctx.lineTo(x, y);
        ctx.stroke();
      }
      ctx.beginPath();
      ctx.arc(x, y, brushSize/2, 0, Math.PI*2);
      ctx.fill();
      lastPoint = { x, y };
    }

    function drawMarker(x, y) {
      if (lastPoint) {
        ctx.beginPath();
        ctx.moveTo(lastPoint.x, lastPoint.y);
        ctx.lineTo(x, y);
        ctx.stroke();
      }
      lastPoint = { x, y };
    }

    function drawPencil(x, y) {
      ctx.globalAlpha = 0.7;
      if (lastPoint) {
        ctx.beginPath();
        ctx.moveTo(lastPoint.x, lastPoint.y);
        ctx.lineTo(x, y);
        ctx.stroke();
      }
      lastPoint = { x, y };
      ctx.globalAlpha = 1;
    }

    function drawSpray(x, y) {
      const density = brushSize * 2;
      for (let i = 0; i < density; i++) {
        const radius = Math.random() * brushSize;
        const angle = Math.random() * Math.PI * 2;
        const sprayX = x + Math.cos(angle) * radius;
        const sprayY = y + Math.sin(angle) * radius;
        
        ctx.beginPath();
        ctx.arc(sprayX, sprayY, 1, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function handleTouchStart(e) {
      e.preventDefault();
      const touch = e.touches[0];
      const mouseEvent = new MouseEvent("mousedown", {
        clientX: touch.clientX,
        clientY: touch.clientY
      });
      canvas.dispatchEvent(mouseEvent);
    }

    function handleTouchMove(e) {
      e.preventDefault();
      const touch = e.touches[0];
      const mouseEvent = new MouseEvent("mousemove", {
        clientX: touch.clientX,
        clientY: touch.clientY
      });
      canvas.dispatchEvent(mouseEvent);
    }

    // Shape drawing functions
    function drawShape(shape) {
      saveDrawingState();
      ctx.fillStyle = brushColor;
      ctx.strokeStyle = brushColor;
      ctx.lineWidth = brushSize;
      
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;
      const size = Math.min(canvas.width, canvas.height) * 0.3;
      
      ctx.beginPath();
      
      switch(shape) {
        case "circle":
          ctx.arc(centerX, centerY, size/2, 0, Math.PI * 2);
          ctx.fill();
          break;
        case "square":
          ctx.rect(centerX - size/2, centerY - size/2, size, size);
          ctx.fill();
          break;
        case "line":
          ctx.moveTo(centerX - size/2, centerY);
          ctx.lineTo(centerX + size/2, centerY);
          ctx.stroke();
          break;
        case "triangle":
          ctx.moveTo(centerX, centerY - size/2);
          ctx.lineTo(centerX + size/2, centerY + size/2);
          ctx.lineTo(centerX - size/2, centerY + size/2);
          ctx.closePath();
          ctx.fill();
          break;
        case "star":
          drawStar(centerX, centerY, 5, size/2, size/4);
          ctx.fill();
          break;
        case "heart":
          drawHeart(centerX, centerY, size/2);
          ctx.fill();
          break;
      }
    }

    function drawStar(cx, cy, spikes, outerRadius, innerRadius) {
      let rot = Math.PI/2 * 3;
      let x = cx;
      let y = cy;
      let step = Math.PI / spikes;

      ctx.beginPath();
      ctx.moveTo(cx, cy - outerRadius);
      
      for(let i = 0; i < spikes; i++) {
        x = cx + Math.cos(rot) * outerRadius;
        y = cy + Math.sin(rot) * outerRadius;
        ctx.lineTo(x, y);
        rot += step;

        x = cx + Math.cos(rot) * innerRadius;
        y = cy + Math.sin(rot) * innerRadius;
        ctx.lineTo(x, y);
        rot += step;
      }
      
      ctx.lineTo(cx, cy - outerRadius);
      ctx.closePath();
    }

    function drawHeart(x, y, size) {
      ctx.beginPath();
      ctx.moveTo(x, y);
      ctx.bezierCurveTo(x, y - size/2, x - size, y - size/2, x - size, y);
      ctx.bezierCurveTo(x - size, y + size/3, x, y + size, x, y + size);
      ctx.bezierCurveTo(x, y + size, x + size, y + size/3, x + size, y);
      ctx.bezierCurveTo(x + size, y - size/2, x, y - size/2, x, y);
      ctx.closePath();
    }

    // Tool functions
    function toggleEraser() {
      isEraser = !isEraser;
      document.getElementById("brushType").value = isEraser ? "crayon" : currentBrush;
    }

    function clearCanvas() {
      saveDrawingState();
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      if (coloringBookMode && coloringBookImage) {
        ctx.drawImage(coloringBookImage, 0, 0, canvas.width, canvas.height);
      }
      if (connectDotsMode) {
        renderDots();
      }
    }

    function fillCanvas() {
      saveDrawingState();
      ctx.fillStyle = brushColor;
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      if (coloringBookMode && coloringBookImage) {
        ctx.drawImage(coloringBookImage, 0, 0, canvas.width, canvas.height);
      }
      if (connectDotsMode) {
        renderDots();
      }
    }

    function addName() {
      saveDrawingState();
      const name = document.getElementById("nameInput").value;
      if (!name) return;
      
      ctx.fillStyle = brushColor;
      ctx.font = "24px Comic Sans MS";
      ctx.fillText(name, 20, 40);
    }

    function stampEmoji(emoji) {
      saveDrawingState();
      ctx.font = `40px serif`;
      ctx.fillStyle = brushColor;
      const x = Math.random() * (canvas.width - 50) + 25;
      const y = Math.random() * (canvas.height - 50) + 25;
      ctx.fillText(emoji, x, y);
    }

    function showStickers() {
      const palette = document.getElementById("stickerPalette");
      palette.style.display = "block";
      palette.style.left = (Math.random() * (window.innerWidth - 200)) + "px";
      palette.style.top = (Math.random() * (window.innerHeight - 200)) + "px";
      
      setTimeout(() => {
        document.addEventListener("click", closeStickers);
      }, 10);
    }

    function closeStickers(e) {
      if (!document.getElementById("stickerPalette").contains(e.target)) {
        document.getElementById("stickerPalette").style.display = "none";
        document.removeEventListener("click", closeStickers);
      }
    }

    // History functions
    function saveDrawingState() {
      if (historyIndex < drawingHistory.length - 1) {
        drawingHistory = drawingHistory.slice(0, historyIndex + 1);
      }
      
      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      drawingHistory.push(imageData);
      historyIndex = drawingHistory.length - 1;
      
      if (drawingHistory.length > 20) {
        drawingHistory.shift();
        historyIndex--;
      }
    }

    function undo() {
      if (historyIndex <= 0) return;
      
      historyIndex--;
      ctx.putImageData(drawingHistory[historyIndex], 0, 0);
      if (coloringBookMode && coloringBookImage) {
        ctx.drawImage(coloringBookImage, 0, 0, canvas.width, canvas.height);
      }
      if (connectDotsMode) {
        renderDots();
      }
    }

    function redo() {
      if (historyIndex >= drawingHistory.length - 1) return;
      
      historyIndex++;
      ctx.putImageData(drawingHistory[historyIndex], 0, 0);
      if (coloringBookMode && coloringBookImage) {
        ctx.drawImage(coloringBookImage, 0, 0, canvas.width, canvas.height);
      }
      if (connectDotsMode) {
        renderDots();
      }
    }

    // Preset functions
    function loadPreset() {
      saveDrawingState();
      const preset = document.getElementById("presetSelect").value;
      clearCanvas();
      
      switch(preset) {
        case "rainbow":
          drawRainbow();
          break;
        case "kitty":
          drawHelloKitty();
          break;
        case "house":
          drawHouse();
          break;
        case "sunset":
          drawSunset();
          break;
      }
    }

    function drawRainbow() {
      const centerX = canvas.width / 2;
      const centerY = canvas.height;
      const radius = Math.min(canvas.width, canvas.height) * 0.8;
      
      const colors = ["red", "orange", "yellow", "green", "blue", "indigo", "violet"];
      
      for (let i = 0; i < colors.length; i++) {
        ctx.beginPath();
        ctx.arc(centerX, centerY, radius - i * 20, Math.PI, 0, false);
        ctx.strokeStyle = colors[i];
        ctx.lineWidth = 20;
        ctx.stroke();
      }
    }

    function drawHelloKitty() {
      // Head
      ctx.fillStyle = "white";
      ctx.beginPath();
      ctx.arc(canvas.width/2, canvas.height/2 - 30, 100, 0, Math.PI * 2);
      ctx.fill();
      
      // Ears
      ctx.beginPath();
      ctx.moveTo(canvas.width/2 - 50, canvas.height/2 - 80);
      ctx.lineTo(canvas.width/2 - 90, canvas.height/2 - 120);
      ctx.lineTo(canvas.width/2 - 40, canvas.height/2 - 110);
      ctx.fill();
      
      ctx.beginPath();
      ctx.moveTo(canvas.width/2 + 50, canvas.height/2 - 80);
      ctx.lineTo(canvas.width/2 + 90, canvas.height/2 - 120);
      ctx.lineTo(canvas.width/2 + 40, canvas.height/2 - 110);
      ctx.fill();
      
      // Bow
      ctx.fillStyle = "#ff66b2";
      ctx.beginPath();
      ctx.arc(canvas.width/2, canvas.height/2 - 90, 20, 0, Math.PI * 2);
      ctx.fill();
      
      ctx.beginPath();
      ctx.moveTo(canvas.width/2 - 20, canvas.height/2 - 90);
      ctx.quadraticCurveTo(canvas.width/2 - 40, canvas.height/2 - 70, canvas.width/2 - 60, canvas.height/2 - 90);
      ctx.quadraticCurveTo(canvas.width/2 - 40, canvas.height/2 - 110, canvas.width/2 - 20, canvas.height/2 - 90);
      ctx.fill();
      
      ctx.beginPath();
      ctx.moveTo(canvas.width/2 + 20, canvas.height/2 - 90);
      ctx.quadraticCurveTo(canvas.width/2 + 40, canvas.height/2 - 70, canvas.width/2 + 60, canvas.height/2 - 90);
      ctx.quadraticCurveTo(canvas.width/2 + 40, canvas.height/2 - 110, canvas.width/2 + 20, canvas.height/2 - 90);
      ctx.fill();
      
      // Eyes
      ctx.fillStyle = "black";
      ctx.beginPath();
      ctx.arc(canvas.width/2 - 30, canvas.height/2 - 40, 10, 0, Math.PI * 2);
      ctx.fill();
      
      ctx.beginPath();
      ctx.arc(canvas.width/2 + 30, canvas.height/2 - 40, 10, 0, Math.PI * 2);
      ctx.fill();
      
      // Nose
      ctx.beginPath();
      ctx.arc(canvas.width/2, canvas.height/2 - 20, 5, 0, Math.PI * 2);
      ctx.fill();
      
      // Whiskers
      ctx.strokeStyle = "black";
      ctx.lineWidth = 2;
      
      ctx.beginPath();
      ctx.moveTo(canvas.width/2 + 5, canvas.height/2 - 15);
      ctx.lineTo(canvas.width/2 + 50, canvas.height/2 - 10);
      ctx.stroke();
      
      ctx.beginPath();
      ctx.moveTo(canvas.width/2 + 5, canvas.height/2 - 10);
      ctx.lineTo(canvas.width/2 + 50, canvas.height/2);
      ctx.stroke();
      
      ctx.beginPath();
      ctx.moveTo(canvas.width/2 + 5, canvas.height/2 - 5);
      ctx.lineTo(canvas.width/2 + 50, canvas.height/2 + 10);
      ctx.stroke();
      
      ctx.beginPath();
      ctx.moveTo(canvas.width/2 - 5, canvas.height/2 - 15);
      ctx.lineTo(canvas.width/2 - 50, canvas.height/2 - 10);
      ctx.stroke();
      
      ctx.beginPath();
      ctx.moveTo(canvas.width/2 - 5, canvas.height/2 - 10);
      ctx.lineTo(canvas.width/2 - 50, canvas.height/2);
      ctx.stroke();
      
      ctx.beginPath();
      ctx.moveTo(canvas.width/2 - 5, canvas.height/2 - 5);
      ctx.lineTo(canvas.width/2 - 50, canvas.height/2 + 10);
      ctx.stroke();
    }

    function drawHouse() {
      // Base
      ctx.fillStyle = "#8B4513";
      ctx.fillRect(canvas.width/2 - 100, canvas.height/2 + 50, 200, 150);
      
      // Roof
      ctx.fillStyle = "#A52A2A";
      ctx.beginPath();
      ctx.moveTo(canvas.width/2 - 120, canvas.height/2 + 50);
      ctx.lineTo(canvas.width/2, canvas.height/2 - 50);
      ctx.lineTo(canvas.width/2 + 120, canvas.height/2 + 50);
      ctx.closePath();
      ctx.fill();
      
      // Door
      ctx.fillStyle = "#654321";
      ctx.fillRect(canvas.width/2 - 30, canvas.height/2 + 100, 60, 100);
      
      // Window
      ctx.fillStyle = "#ADD8E6";
      ctx.fillRect(canvas.width/2 - 80, canvas.height/2 + 70, 40, 40);
      ctx.fillRect(canvas.width/2 + 40, canvas.height/2 + 70, 40, 40);
      
      // Window frames
      ctx.strokeStyle = "black";
      ctx.lineWidth = 2;
      ctx.strokeRect(canvas.width/2 - 80, canvas.height/2 + 70, 40, 40);
      ctx.beginPath();
      ctx.moveTo(canvas.width/2 - 60, canvas.height/2 + 70);
      ctx.lineTo(canvas.width/2 - 60, canvas.height/2 + 110);
      ctx.moveTo(canvas.width/2 - 80, canvas.height/2 + 90);
      ctx.lineTo(canvas.width/2 - 40, canvas.height/2 + 90);
      ctx.stroke();
      
      ctx.strokeRect(canvas.width/2 + 40, canvas.height/2 + 70, 40, 40);
      ctx.beginPath();
      ctx.moveTo(canvas.width/2 + 60, canvas.height/2 + 70);
      ctx.lineTo(canvas.width/2 + 60, canvas.height/2 + 110);
      ctx.moveTo(canvas.width/2 + 40, canvas.height/2 + 90);
      ctx.lineTo(canvas.width/2 + 80, canvas.height/2 + 90);
      ctx.stroke();
    }

    function drawSunset() {
      // Sky gradient
      const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
      gradient.addColorStop(0, "#FF4500");
      gradient.addColorStop(0.5, "#FF8C00");
      gradient.addColorStop(1, "#FFD700");
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      // Sun
      ctx.fillStyle = "#FFD700";
      ctx.beginPath();
      ctx.arc(canvas.width/2, canvas.height + 50, 150, 0, Math.PI, true);
      ctx.fill();
      
      // Ocean
      ctx.fillStyle = "#1E90FF";
      ctx.fillRect(0, canvas.height/2 + 100, canvas.width, canvas.height/2 - 100);
      
      // Waves
      ctx.strokeStyle = "#00008B";
      ctx.lineWidth = 2;
      for (let i = 0; i < 10; i++) {
        ctx.beginPath();
        ctx.moveTo(i * 100, canvas.height/2 + 120 + Math.sin(i) * 10);
        ctx.quadraticCurveTo(
          i * 100 + 50, canvas.height/2 + 110 + Math.sin(i + 0.5) * 10,
          i * 100 + 100, canvas.height/2 + 120 + Math.sin(i + 1) * 10
        );
        ctx.stroke();
      }
    }

    // Theme functions
    function changeTheme(theme) {
      switch(theme) {
        case "pink":
          document.body.style.background = "linear-gradient(to bottom right, #ffe4f1, #ffc1e3)";
          canvas.style.backgroundColor = "#ff66b2";
          break;
        case "sky":
          document.body.style.background = "linear-gradient(to bottom right, #e0f7ff, #a8dfff)";
          canvas.style.backgroundColor = "#66b3ff";
          break;
        case "mint":
          document.body.style.background = "linear-gradient(to bottom right, #d1fff2, #a0ffd6)";
          canvas.style.backgroundColor = "#66ffb3";
          break;
        case "unicorn":
          document.body.style.background = "linear-gradient(to bottom right, #ffcce6, #ffccf2, #f2ccff, #e6ccff, #ccf2ff, #ccffff, #ccffcc)";
          canvas.style.backgroundColor = "white";
          break;
      }
    }

    // Save/export functions
    function saveImage(type) {
      let link = document.createElement("a");
      const fileName = `DrawHelloKitty_${new Date().toISOString().slice(0,10)}.${type}`;
      link.download = fileName;

      if (type === "pdf") {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF();
        const imgData = canvas.toDataURL("image/png");
        pdf.addImage(imgData, "PNG", 10, 10, canvas.width / 4, canvas.height / 4);
        pdf.save(fileName);
        return;
      } else {
        link.href = canvas.toDataURL(`image/${type}`);
      }
      link.click();
    }

    function printCanvas() {
      const dataUrl = canvas.toDataURL("image/png");
      const windowContent = '<!DOCTYPE html><html><head><title>Print Canvas</title></head><body><img src="' + dataUrl + '"></body></html>';
      const printWin = window.open('', '', 'width=800,height=600');
      printWin.document.write(windowContent);
      printWin.document.close();
      printWin.focus();
      printWin.print();
      printWin.close();
    }

    // Coloring book mode
    function startColoringBook() {
      saveDrawingState();
      coloringBookMode = true;
      connectDotsMode = false;
      clearCanvas();
      
      coloringBookImage = new Image();
      coloringBookImage.src = createColoringBookImage();
      coloringBookImage.onload = () => {
        ctx.drawImage(coloringBookImage, 0, 0, canvas.width, canvas.height);
      };
    }

    function createColoringBookImage() {
      const tempCanvas = document.createElement("canvas");
      tempCanvas.width = canvas.width;
      tempCanvas.height = canvas.height;
      const tempCtx = tempCanvas.getContext("2d");
      
      // Draw a simple Hello Kitty outline
      tempCtx.strokeStyle = "black";
      tempCtx.lineWidth = 2;
      
      // Head
      tempCtx.beginPath();
      tempCtx.arc(canvas.width/2, canvas.height/2 - 30, 100, 0, Math.PI * 2);
      tempCtx.stroke();
      
      // Ears
      tempCtx.beginPath();
      tempCtx.moveTo(canvas.width/2 - 50, canvas.height/2 - 80);
      tempCtx.lineTo(canvas.width/2 - 90, canvas.height/2 - 120);
      tempCtx.lineTo(canvas.width/2 - 40, canvas.height/2 - 110);
      tempCtx.closePath();
      tempCtx.stroke();
      
      tempCtx.beginPath();
      tempCtx.moveTo(canvas.width/2 + 50, canvas.height/2 - 80);
      tempCtx.lineTo(canvas.width/2 + 90, canvas.height/2 - 120);
      tempCtx.lineTo(canvas.width/2 + 40, canvas.height/2 - 110);
      tempCtx.closePath();
      tempCtx.stroke();
      
      // Bow
      tempCtx.beginPath();
      tempCtx.arc(canvas.width/2, canvas.height/2 - 90, 20, 0, Math.PI * 2);
      tempCtx.stroke();
      
      return tempCanvas.toDataURL();
    }

    // Connect-the-dots mode
    function startConnectDots() {
      saveDrawingState();
      connectDotsMode = true;
      coloringBookMode = false;
      clearCanvas();
      dotPoints = generateDots();
      renderDots();
    }

    function generateDots() {
      const points = [];
      const numDots = 10;
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;
      const radius = 150;
      
      for (let i = 0; i < numDots; i++) {
        const angle = (i / numDots) * Math.PI * 2;
        const x = centerX + Math.cos(angle) * radius;
        const y = centerY + Math.sin(angle) * radius;
        points.push({ x, y, number: i + 1 });
      }
      return points;
    }

    function renderDots() {
      ctx.fillStyle = "black";
      ctx.font = "20px Comic Sans MS";
      dotPoints.forEach(point => {
        ctx.beginPath();
        ctx.arc(point.x, point.y, 5, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillText(point.number, point.x + 10, point.y + 10);
      });
    }

    function handleSpecialMode(e) {
      const rect = canvas.getBoundingClientRect();
      const x = (e.clientX || e.touches[0].clientX) - rect.left;
      const y = (e.clientY || e.touches[0].clientY) - rect.top;
      
      if (connectDotsMode) {
        const clickedDot = dotPoints.find(dot => 
          Math.sqrt((dot.x - x) ** 2 + (dot.y - y) ** 2) < 10
        );
        if (clickedDot && clickedDot.number === dotPoints[0].number) {
          saveDrawingState();
          ctx.beginPath();
          ctx.moveTo(clickedDot.x, clickedDot.y);
          dotPoints.push(dotPoints.shift());
          renderDots();
        } else if (clickedDot && clickedDot.number === dotPoints[0].number + 1) {
          saveDrawingState();
          ctx.strokeStyle = brushColor;
          ctx.lineWidth = brushSize;
          ctx.lineTo(clickedDot.x, clickedDot.y);
          ctx.stroke();
          dotPoints.push(dotPoints.shift());
          renderDots();
        }
      }
    }

    // Game functions
    function closeGame() {
      document.getElementById("gameContainer").style.display = "none";
      gameCanvas.onclick = null;
      if (drawingChallengeTimer) {
        clearInterval(drawingChallengeTimer);
        drawingChallengeTimer = null;
      }
      currentGame = null;
    }

    function startMemoryGame() {
      currentGame = "memory";
      document.getElementById("gameContainer").style.display = "flex";
      document.getElementById("gameTitle").textContent = "Memory Match Game";
      document.getElementById("gameInstructions").textContent = "Click to flip cards and find matching pairs!";
      gameScore = 0;
      document.getElementById("gameScore").textContent = `Score: ${gameScore}`;
      memoryCards = ["üò∫", "üò∫", "üå∏", "üå∏", "‚≠ê", "‚≠ê", "üéÄ", "üéÄ"].sort(() => Math.random() - 0.5);
      matchedCards = [];
      flippedCards = [];
      renderMemoryGame();
      gameCanvas.onclick = handleMemoryCardClick;
    }

    function renderMemoryGame() {
      gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
      const cardWidth = 80;
      const cardHeight = 80;
      const gap = 20;
      for (let i = 0; i < 8; i++) {
        const x = (i % 4) * (cardWidth + gap) + gap;
        const y = Math.floor(i / 4) * (cardHeight + gap) + gap;
        gameCtx.fillStyle = matchedCards.includes(i) || flippedCards.includes(i) ? "#fff" : "#ff66b2";
        gameCtx.fillRect(x, y, cardWidth, cardHeight);
        if (matchedCards.includes(i) || flippedCards.includes(i)) {
          gameCtx.font = "40px serif";
          gameCtx.fillStyle = "black";
          gameCtx.fillText(memoryCards[i], x + 20, y + 60);
        }
      }
    }

    function handleMemoryCardClick(e) {
      const rect = gameCanvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      const cardWidth = 80;
      const cardHeight = 80;
      const gap = 20;
      
      const col = Math.floor((x - gap) / (cardWidth + gap));
      const row = Math.floor((y - gap) / (cardHeight + gap));
      const index = row * 4 + col;
      
      if (col >= 0 && col < 4 && row >= 0 && row < 2 && !matchedCards.includes(index) && !flippedCards.includes(index)) {
        flippedCards.push(index);
        renderMemoryGame();
        
        if (flippedCards.length === 2) {
          const [first, second] = flippedCards;
          if (memoryCards[first] === memoryCards[second]) {
            matchedCards.push(first, second);
            gameScore += 10;
            document.getElementById("gameScore").textContent = `Score: ${gameScore}`;
            flippedCards = [];
            if (matchedCards.length === memoryCards.length) {
              setTimeout(() => alert("You won the Memory Match Game!"), 500);
            }
          } else {
            setTimeout(() => {
              flippedCards = [];
              renderMemoryGame();
            }, 1000);
          }
        }
      }
    }

    function startGuessingGame() {
      currentGame = "colorGuessing";
      document.getElementById("gameContainer").style.display = "flex";
      document.getElementById("gameTitle").textContent = "Color Guessing Game";
      document.getElementById("gameInstructions").textContent = "Click the color that matches the target color!";
      gameScore = 0;
      document.getElementById("gameScore").textContent = `Score: ${gameScore}`;
      generateColorRound();
      gameCanvas.onclick = handleColorGuess;
    }

    function generateColorRound() {
      colorOptions = [
        `#${Math.floor(Math.random()*16777215).toString(16)}`,
        `#${Math.floor(Math.random()*16777215).toString(16)}`,
        `#${Math.floor(Math.random()*16777215).toString(16)}`,
        `#${Math.floor(Math.random()*16777215).toString(16)}`
      ];
      targetColor = colorOptions[Math.floor(Math.random() * 4)];
      renderColorGuessingGame();
    }

    function renderColorGuessingGame() {
      gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
      gameCtx.fillStyle = targetColor;
      gameCtx.fillRect(50, 50, 300, 100);
      
      for (let i = 0; i < 4; i++) {
        gameCtx.fillStyle = colorOptions[i];
        gameCtx.fillRect(50 + i * 80, 200, 60, 60);
      }
    }

    function handleColorGuess(e) {
      const rect = gameCanvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      
      if (y >= 200 && y <= 260) {
        const index = Math.floor((x - 50) / 80);
        if (index >= 0 && index < 4) {
          if (colorOptions[index] === targetColor) {
            gameScore += 5;
            document.getElementById("gameScore").textContent = `Score: ${gameScore}`;
            generateColorRound();
          } else {
            gameScore = Math.max(0, gameScore - 2);
            document.getElementById("gameScore").textContent = `Score: ${gameScore}`;
          }
        }
      }
    }

    function startDrawingGame() {
      currentGame = "drawingChallenge";
      document.getElementById("gameContainer").style.display = "flex";
      document.getElementById("gameTitle").textContent = "Drawing Challenge";
      const words = ["cat", "flower", "house", "star", "rainbow"];
      drawingChallengeWord = words[Math.floor(Math.random() * words.length)];
      document.getElementById("gameInstructions").textContent = `Draw a ${drawingChallengeWord} in 60 seconds! Click Close to submit.`;
      gameScore = 0;
      document.getElementById("gameScore").textContent = `Time Left: ${timeLeft}s`;
      gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
      timeLeft = 60;
      drawingChallengeTimer = setInterval(() => {
        timeLeft--;
        document.getElementById("gameScore").textContent = `Time Left: ${timeLeft}s`;
        if (timeLeft <= 0) {
          clearInterval(drawingChallengeTimer);
          alert("Time's up! Your drawing was great!");
          closeGame();
        }
      }, 1000);
      gameCanvas.onmousedown = startGameDrawing;
      gameCanvas.onmousemove = drawInGame;
      gameCanvas.onmouseup = stopGameDrawing;
    }

    let gameDrawing = false;
    let gameLastPoint = null;

    function startGameDrawing(e) {
      gameDrawing = true;
      drawInGame(e);
    }

    function stopGameDrawing() {
      gameDrawing = false;
      gameCtx.beginPath();
      gameLastPoint = null;
    }

    function drawInGame(e) {
      if (!gameDrawing) return;
      
      const rect = gameCanvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      
      gameCtx.strokeStyle = brushColor;
      gameCtx.lineWidth = brushSize;
      gameCtx.lineJoin = "round";
      gameCtx.lineCap = "round";
      
      if (gameLastPoint) {
        gameCtx.beginPath();
        gameCtx.moveTo(gameLastPoint.x, gameLastPoint.y);
        gameCtx.lineTo(x, y);
        gameCtx.stroke();
      }
      gameLastPoint = { x, y };
    }

    // Tutorial functions
    function showStepByStep(type) {
      document.getElementById("gameContainer").style.display = "flex";
      document.getElementById("gameTitle").textContent = `Learn to Draw a ${type.charAt(0).toUpperCase() + type.slice(1)}`;
      document.getElementById("gameInstructions").textContent = "Follow the steps to draw!";
      document.getElementById("gameScore").textContent = "";
      
      const steps = {
        cat: [
          () => {
            gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            gameCtx.beginPath();
            gameCtx.arc(200, 200, 80, 0, Math.PI * 2);
            gameCtx.stroke();
            gameCtx.fillText("Step 1: Draw a circle for the head", 50, 350);
          },
          () => {
            gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            gameCtx.beginPath();
            gameCtx.arc(200, 200, 80, 0, Math.PI * 2);
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.moveTo(160, 120);
            gameCtx.lineTo(140, 80);
            gameCtx.lineTo(180, 100);
            gameCtx.closePath();
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.moveTo(240, 120);
            gameCtx.lineTo(260, 80);
            gameCtx.lineTo(220, 100);
            gameCtx.closePath();
            gameCtx.stroke();
            gameCtx.fillText("Step 2: Add two triangle ears", 50, 350);
          },
          () => {
            gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            gameCtx.beginPath();
            gameCtx.arc(200, 200, 80, 0, Math.PI * 2);
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.moveTo(160, 120);
            gameCtx.lineTo(140, 80);
            gameCtx.lineTo(180, 100);
            gameCtx.closePath();
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.moveTo(240, 120);
            gameCtx.lineTo(260, 80);
            gameCtx.lineTo(220, 100);
            gameCtx.closePath();
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.arc(180, 180, 5, 0, Math.PI * 2);
            gameCtx.fill();
            gameCtx.beginPath();
            gameCtx.arc(220, 180, 5, 0, Math.PI * 2);
            gameCtx.fill();
            gameCtx.beginPath();
            gameCtx.moveTo(200, 200);
            gameCtx.lineTo(190, 210);
            gameCtx.lineTo(210, 210);
            gameCtx.closePath();
            gameCtx.fill();
            gameCtx.fillText("Step 3: Add eyes and nose", 50, 350);
          },
          () => {
            gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            gameCtx.beginPath();
            gameCtx.arc(200, 200, 80, 0, Math.PI * 2);
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.moveTo(160, 120);
            gameCtx.lineTo(140, 80);
            gameCtx.lineTo(180, 100);
            gameCtx.closePath();
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.moveTo(240, 120);
            gameCtx.lineTo(260, 80);
            gameCtx.lineTo(220, 100);
            gameCtx.closePath();
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.arc(180, 180, 5, 0, Math.PI * 2);
            gameCtx.fill();
            gameCtx.beginPath();
            gameCtx.arc(220, 180, 5, 0, Math.PI * 2);
            gameCtx.fill();
            gameCtx.beginPath();
            gameCtx.moveTo(200, 200);
            gameCtx.lineTo(190, 210);
            gameCtx.lineTo(210, 210);
            gameCtx.closePath();
            gameCtx.fill();
            gameCtx.beginPath();
            gameCtx.moveTo(160, 200);
            gameCtx.lineTo(140, 200);
            gameCtx.moveTo(160, 210);
            gameCtx.lineTo(140, 210);
            gameCtx.moveTo(240, 200);
            gameCtx.lineTo(260, 200);
            gameCtx.moveTo(240, 210);
            gameCtx.lineTo(260, 210);
            gameCtx.stroke();
            gameCtx.fillText("Step 4: Add whiskers", 50, 350);
          },
          () => {
            gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            gameCtx.beginPath();
            gameCtx.arc(200, 200, 80, 0, Math.PI * 2);
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.moveTo(160, 120);
            gameCtx.lineTo(140, 80);
            gameCtx.lineTo(180, 100);
            gameCtx.closePath();
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.moveTo(240, 120);
            gameCtx.lineTo(260, 80);
            gameCtx.lineTo(220, 100);
            gameCtx.closePath();
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.arc(180, 180, 5, 0, Math.PI * 2);
            gameCtx.fill();
            gameCtx.beginPath();
            gameCtx.arc(220, 180, 5, 0, Math.PI * 2);
            gameCtx.fill();
            gameCtx.beginPath();
            gameCtx.moveTo(200, 200);
            gameCtx.lineTo(190, 210);
            gameCtx.lineTo(210, 210);
            gameCtx.closePath();
            gameCtx.fill();
            gameCtx.beginPath();
            gameCtx.moveTo(160, 200);
            gameCtx.lineTo(140, 200);
            gameCtx.moveTo(160, 210);
            gameCtx.lineTo(140, 210);
            gameCtx.moveTo(240, 200);
            gameCtx.lineTo(260, 200);
            gameCtx.moveTo(240, 210);
            gameCtx.lineTo(260, 210);
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.arc(200, 220, 10, Math.PI, 0);
            gameCtx.stroke();
            gameCtx.fillText("Step 5: Add a smiling mouth", 50, 350);
          }
        ],
        flower: [
          () => {
            gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            gameCtx.beginPath();
            gameCtx.arc(200, 200, 20, 0, Math.PI * 2);
            gameCtx.stroke();
            gameCtx.fillText("Step 1: Draw a small circle", 50, 350);
          },
          () => {
            gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            gameCtx.beginPath();
            gameCtx.arc(200, 200, 20, 0, Math.PI * 2);
            gameCtx.stroke();
            for (let i = 0; i < 8; i++) {
              const angle = (i / 8) * Math.PI * 2;
              gameCtx.beginPath();
              gameCtx.ellipse(200 + Math.cos(angle) * 40, 200 + Math.sin(angle) * 40, 10, 20, angle, 0, Math.PI * 2);
              gameCtx.stroke();
            }
            gameCtx.fillText("Step 2: Add petals around it", 50, 350);
          },
          () => {
            gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            gameCtx.beginPath();
            gameCtx.arc(200, 200, 20, 0, Math.PI * 2);
            gameCtx.stroke();
            for (let i = 0; i < 8; i++) {
              const angle = (i / 8) * Math.PI * 2;
              gameCtx.beginPath();
              gameCtx.ellipse(200 + Math.cos(angle) * 40, 200 + Math.sin(angle) * 40, 10, 20, angle, 0, Math.PI * 2);
              gameCtx.stroke();
            }
            gameCtx.beginPath();
            gameCtx.moveTo(200, 220);
            gameCtx.lineTo(200, 300);
            gameCtx.stroke();
            gameCtx.fillText("Step 3: Draw a stem", 50, 350);
          },
          () => {
            gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            gameCtx.beginPath();
            gameCtx.arc(200, 200, 20, 0, Math.PI * 2);
            gameCtx.stroke();
            for (let i = 0; i < 8; i++) {
              const angle = (i / 8) * Math.PI * 2;
              gameCtx.beginPath();
              gameCtx.ellipse(200 + Math.cos(angle) * 40, 200 + Math.sin(angle) * 40, 10, 20, angle, 0, Math.PI * 2);
              gameCtx.stroke();
            }
            gameCtx.beginPath();
            gameCtx.moveTo(200, 220);
            gameCtx.lineTo(200, 300);
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.ellipse(180, 260, 10, 20, Math.PI / 4, 0, Math.PI * 2);
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.ellipse(220, 260, 10, 20, -Math.PI / 4, 0, Math.PI * 2);
            gameCtx.stroke();
            gameCtx.fillText("Step 4: Add leaves", 50, 350);
          }
        ]
      };

      let currentStep = 0;
      steps[type][currentStep]();
      
      gameCanvas.onclick = () => {
        currentStep = (currentStep + 1) % steps[type].length;
        steps[type][currentStep]();
      };
    }
  </script>
</body>
</html>
